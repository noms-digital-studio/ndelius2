@import data._
@import helper._
@import paroleParom1Report.hiddenInputs._
@import play.Environment
@import data.viewModel.PageStatus
@import org.webjars.play.WebJarsUtil
@import fragment.popup
@import com.typesafe.config.Config

@(reportForm: Form[ParoleParom1ReportData], encrypter: String => String)(implicit pageStatuses: Map[Int, PageStatus], webJarsUtil: WebJarsUtil, environment: Environment, configuration: Config)

@implicitField = @{
    FieldConstructor(govukElements.f)
}

@currentSituationHint = {
    <p class="govuk-body">Provide a brief summary of the case, areas of risk and current motivation to engage with the plan.</p>
    <p class="govuk-body govuk-!-margin-top-4">Include the OASys generated text as well as the summary provided by the author.</p>
    <p class="govuk-body govuk-!-margin-top-4">This summary should provide a reader an overview of how these strategies fit with the risk and situation presented.</p>
    <p class="govuk-body govuk-!-margin-top-4">For detailed guidance see Risk of Serious Harm Guidance or OASys help section</p>
}

@supervisionHint = {
    <p class="govuk-body">Having contact with the person. This is not limited to the HMPPS staff working with the them but includes engagement with any other agencies.</p>
    <p class="govuk-body govuk-!-margin-top-4">Outline:</p>
    <ul class="govuk-list govuk-list--bullet govuk-!-margin-top-2">
        <li>the frequency of contact</li>
        <li>the need for supervised accommodation</li>
        <li>any activity to develop protective factors</li>
        <li>the role of supervision such as focussing on compliance and motivational work</li>
    </ul>
    <p class="govuk-body govuk-!-margin-top-4">Examples of supervision include:</p>
    <ul class="govuk-list govuk-list--bullet govuk-!-margin-top-2">
        <li>office-based supervision/li>
        <li>home visits (from all parties)</li>
        <li>contact with healthcare professionals / treatment providers</li>
        <li>interaction with staff in Approved Premises</li>
        <li>tenancy support from Housing Associations</li>
        <li>employment advocacy</li>
        <li>education</li>
        <li>mentoring</li>
    </ul>
    <p class="govuk-body govuk-!-margin-top-4">For detailed guidance see Risk of Serious Harm Guidance or OASys help section</p>
}

@monitoringControlHint = {
    <p class="govuk-body">The strategies you design to detect the build up to serious harm and prevent it happening.</p>
    <p class="govuk-body govuk-!-margin-top-4">Monitoring can take many forms including:</p>
    <ul class="govuk-list govuk-list--bullet govuk-!-margin-top-2">
        <li>monitoring of internet use through monitoring software or limiting use to a specific device</li>
        <li>Overnight stays (community) to test implementation of learning and test out resettlement plans</li>
        <li>direct surveillance</li>
        <li>sharing information and asking for updates from risk management partners</li>
        <li>polygraph testing</li>
        <li>drug testing </li>
        <li>electronic and location monitoring</li>
    </ul>
    <p class="govuk-body govuk-!-margin-top-4">Control is the part of the plan that aims to reduce the opportunities for an offender to cause serious harm and usually refers to different types of restriction such as:</p>
    <ul class="govuk-list govuk-list--bullet govuk-!-margin-top-2">
        <li>the use of licence conditions including restrictions on accommodation, associations, activities and movements</li>
        <li>electronic monitoring to enforce a curfew or exclusion zone</li>
        <li>the use of restrictive orders such as Sexual Harm Prevention Orders or Gang Injunctions</li>
        <li>the use of warning markers to notify staff of specific risks, such as weapons</li>
        <li>custody restrictions</li>
    </ul>
    <p class="govuk-body govuk-!-margin-top-4">For detailed guidance see Risk of Serious Harm Guidance or OASys help section</p>
}

@interventionsTreatmentHint = {
    <p class="govuk-body">Work that develops internal controls.</p>
    <p class="govuk-body govuk-!-margin-top-4">Likely to involve accredited programmes, developing protective factors such as strengths and personal resources, or engaging in treatment.</p>
    <p class="govuk-body govuk-!-margin-top-4">They may:</p>
    <ul class="govuk-list govuk-list--bullet govuk-!-margin-top-2">
        <li>include proven accredited programmes</li>
        <li>involve a number of agencies and personnel</li>
        <li>be delivered one-to-one</li>
        <li>comprise a number of actions and activities that require coordination and sequencing</li>
        <li>●	involve use of the <a class="govuk-link govuk-link--no-visited-state" href="http://nomsintranet.org.uk/roh/roh/4-risk_management/04_02_03.htm" target="_blank">good lives model</a></li>
    </ul>
    <p class="govuk-body govuk-!-margin-top-4">For detailed guidance see Risk of Serious Harm Guidance or OASys help section</p>
}

@victimSafetyPlanningHint = {
    <p class="govuk-body">Record what steps to safeguard Individuals.  These may be the victims of the index offence, or identified people who you assess to be at risk.</p>
    <p class="govuk-body govuk-!-margin-top-4">Diversity considerations</p>
    <p class="govuk-body govuk-!-margin-top-4">Examples of victim safety actions include:</p>
    <ul class="govuk-list govuk-list--bullet govuk-!-margin-top-2">
        <li>the disclosure of information to third parties</li>
        <li>action by Children’s Social Care</li>
        <li>exclusion zones and non-contact licence conditions</li>
        <li>restraining and other orders</li>
        <li>visits being restricted via the measures in the <a class="govuk-link govuk-link--no-visited-state" href="https://www.justice.gov.uk/downloads/offenders/psipso/psi-2016/psi-18-2016-pi-17-2016-public-protection-manual.pdf" target="_blank">Public Protection Manual</a></li>
        <li>supervised visits to a vulnerable adult relative</li>
        <li>safeguarding flagging on relevant addresses</li>
    </ul>
    <p class="govuk-body govuk-!-margin-top-4">For detailed guidance see Risk of Serious Harm Guidance or OASys help section</p>
}

@contingencyPlanHint = {
    <p class="govuk-body">Link contingency plans to the factors identified in the risk assessment and are most helpful in the format: if X happens then Y must be done, and why.</p>
    <p class="govuk-body govuk-!-margin-top-4">Include action to ensure victim safety, prevent offending through controls and through interventions and supervision to offer greater support.</p>
    <p class="govuk-body govuk-!-margin-top-4">Consider when and why recall/breach action should be considered and any immediate safeguarding activity may be required</p>
    <p class="govuk-body govuk-!-margin-top-4">Diversity considerations</p>
    <p class="govuk-body govuk-!-margin-top-4">For detailed guidance see Risk of Serious Harm Guidance or OASys help section</p>
}

@popup(reportForm, encrypter, "Risk Management Plan (RMP)", 16) {

    <div class="govuk-warning-text moj-warning-text">
        <span aria-hidden="true" class="govuk-warning-text__icon">!</span>
        <strong class="govuk-warning-text__text">
            <span class="govuk-warning-text__assistive">Warning</span>
            You must complete the RMP for all on or post-tariff prisoners, even if you are not supporting release or they are subject to deportation
        </strong>
    </div>

    <h2 class="govuk-fieldset__heading">
        <p class="govuk-caption-xl govuk-!-margin-top-0 govuk-!-margin-bottom-0">Detail the risk management plan (RMP)</p>
    </h2>

    <details class="govuk-details govuk-!-margin-top-0 govuk-!-margin-bottom-6 no-margin-top margin-bottom medium">
        <summary class="govuk-details__summary">
            <span class="govuk-details__summary-text">RMP guidance</span>
        </summary>
        <div class="govuk-details__text panel panel-border-narrow">
            <p>If the prisoner is pre-tariff the parole board do not require an RMP - it should be in the supporting OASys document.</p>
            <p>The community RMP must include what other agencies will do to manage the risk presented by the offender.</p>
            <p>Providing a custodial (closed or open prison) based RMP will not assist the Parole Board to make an informed decision about release.</p>
            <p>Failure to provide a community RMP when one is required could cause further delay to proceedings and the prisoner pursuing action.</p>
            <p>The accompanying OASys can detail both a custodial and community RMP.</p>
            <p>For those on or post-tariff, your report must consider the Parole Board’s statutory release test: ‘that it is no longer necessary for the protection of the public that the offender be confined.’</p>
            <p>You do not need to state the test definition but you should be clear that manageability in the community has been considered, assessed and applied.</p>

        </div>
    </details>

    <div class="form-group" data-module="radios">
        <fieldset class="govuk-fieldset govuk-!-margin-bottom-1">
            <legend class="govuk-fieldset__legend govuk-label">
                Does the prisoner require a community RMP?
            </legend>

            @inputRadioGroup(
                reportForm("riskManagementPlanRequired"),
                options(
                    "yes" -> "Yes",
                    "no" -> "No"
                ),
                '_inline -> "true",
                Symbol("data-aria-controls") -> "risk-management-plan"
            )
        </fieldset>

        <div class="govuk-radios__conditional govuk-radios__conditional--hidden" id="risk-management-plan-yes">

            @textarea(reportForm("currentSituation"), '_label -> "Current situation", '_hint -> currentSituationHint, 'class -> "wide")

            <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible govuk-!-margin-top-0"/>

            @textarea(reportForm("supervision"), '_label -> "Supervision", '_hint -> supervisionHint, 'class -> "wide")

            <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible govuk-!-margin-top-0"/>

            @textarea(reportForm("monitoringControl"), '_label -> "Monitoring / Control", '_hint -> monitoringControlHint, 'class -> "wide")

            <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible govuk-!-margin-top-0"/>

            @textarea(reportForm("interventionsTreatment"), '_label -> "Interventions / Treatment", '_hint -> interventionsTreatmentHint, 'class -> "wide")

            <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible govuk-!-margin-top-0"/>

            @textarea(reportForm("victimSafetyPlanning"), '_label -> "Victim safety planning", '_form_hint -> "Do not record here any information about the victim that will compromise their safety.", '_hint -> victimSafetyPlanningHint, 'class -> "wide")

            <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible govuk-!-margin-top-0"/>

            @textarea(reportForm("contingencyPlan"), '_label -> "Contingency plan", '_hint -> contingencyPlanHint, 'class -> "wide")

        </div>
    </div>

}
